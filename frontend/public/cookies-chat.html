<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cookies Customer Care Chat</title>
    <script src="appearance.js" defer></script>
    <link rel="stylesheet" href="appearance.css">

    <style>
        body {
            font-family: Arial, sans-serif;
            background: #ebadad;
            margin: 0;
            padding: 0;
        }

        
/* Back Button */
.back-logo {
            position: absolute;
            top: 30px;
            left: 20px;
        }

        .back-logo img {
            width: 10px;
            height: auto;
            cursor: pointer;
        }
        .send-btn {
    background: #ff0000;
    color: white;
    margin-left: 10px; /* Space between input and send button */
}

.clear-btn {
    background: red;
    color: white;
    margin-right: auto; /* Pushes Clear button to the left */
}


        .chat-title {
    width: 90%;
    max-width: 500px;
    font-size: 20px;
    font-weight: bold;
    text-align: left;
    margin: 60px auto 10px auto; /* Increased top margin */
    padding-left: 10px; /* Optional for spacing */
}

.container {
    width: 95%; /* Increased width on PC view */
    max-width: 700px; /* Increased max width */
    margin: 10px auto;
    background: white;
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
    display: flex;
    flex-direction: column;
    min-height: auto;
    height: auto;
}

/* Adjust container height in mobile view */
@media (max-width: 480px) {
    .container {
        width: 87%;
        padding: 15px;
        min-height: auto; /* Let it adjust naturally */
        height: auto;
    }
}
.date {
    text-align: center;
    font-size: 14px;
    color: gray;
    margin-bottom: 10px;
}

.chat-box::-webkit-scrollbar {
    display: none; /* Hides scrollbar in Chrome, Safari, Edge */
}

/* Reduce chat-box height */
.chat-box {
    max-height: 300px; /* Reduced height */
    height: 300px;
    overflow-y: auto;
    padding: 10px;
    border-radius: 10px;
    background: #fff;
    border: 1px solid #ddd;
    scrollbar-width: none;
}

/* Mobile view adjustments */
@media (max-width: 480px) {
    .container {
        width: 87%;
        padding: 15px;
        min-height: auto;
        height: auto;
    }

    .chat-box {
        max-height: 600px; /* Increased height on mobile */
        height: 600px;
    }
}

        .message {
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 10px;
            max-width: 80%;
            word-wrap: break-word;
        }
        .bot-message {
            background: #ffdcdc;
            text-align: left;
        }
        .user-message {
            background: #c7dae9;
            text-align: right;
            margin-left: auto;
        }
        .input-container {
    display: flex;
    align-items: center;
    padding: 15px 10px; /* Increased top and bottom padding */
    background: white;
    position: fixed;
    bottom: 0;
    width: 100%;
    left: 0;
    border-top: 1px solid #ddd;
    gap: 8px;
    justify-content: space-between;
    padding-right: 15px; /* Add right padding to create space */
    min-height: 50px; /* Set minimum height */
}


.message-input {
    flex: 1;
    padding: 13px;
    border: 1px solid #ddd;
    border-radius: 5px;
    outline: none;
}

.button-group {
    display: flex;
    gap: 10px;
}

.send-btn, .clear-btn {
    padding: 11px 12px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}

.send-btn {
    background: #ff0000;
    color: white;
}

.clear-btn {
    background: rgb(23, 209, 39);
    color: white;
    margin-right: 20px; /* Increase margin to move it more left */
}



        .inactive-message {
            text-align: center;
            font-size: 12px;
            color: red;
            margin-top: 10px;
            display: none;
        }

        .message-time {
    display: block;  /* Moves time to a new line */
    font-size: 12px; /* Increased font size */
    color: gray; /* Subtle color */
    margin-top: 5px; /* Adds spacing between message and time */
}

/* Dark Mode - Container */
.dark-mode .container {
    background: #222; /* Dark background */
    color: #fff; /* Light text */
    box-shadow: 0px 4px 10px rgba(255, 255, 255, 0.1);
}

/* Dark Mode - Chat Title */
.dark-mode .chat-title {
    color: #f8f8f8;
}

/* Dark Mode - Chat Box */
.dark-mode .chat-box {
    background: #333; /* Darker chat background */
    border: 1px solid #555; /* Subtle border */
    color: white;
}

/* Dark Mode - Messages */
.dark-mode .user-message {
    background: #007bff; /* Blue for user messages */
    color: white;
}

.dark-mode .bot-message {
    background: #444; /* Darker background for bot messages */
    color: #ddd;
}

/* Dark Mode - Date */
.dark-mode .date {
    color: #bbb; /* Light gray */
}

/* Dark Mode - Message Input */
.dark-mode .message-input {
    background: #333;
    color: white;
    border: 1px solid #555;
}

/* Dark Mode - Buttons */
.dark-mode .send-btn {
    background: #ff3b3b; /* Dark red */
}

.dark-mode .clear-btn {
    background: #17a636; /* Darker green */
}

/* Dark Mode - Input Container */
.dark-mode .input-container {
    background: #222; /* Dark background */
    border-top: 1px solid #444;
}

/* Dark Mode - Message Time */
.dark-mode .message-time {
    color: #aaa; /* Soft gray */
}


    </style>
</head>
<body>

    <div class="back-logo">
        <a href="settings.html" class="back-log">
            <div class="back-loco">
                <img src="static/pngkey.com-menu-icon-png-9694963.png" alt="back-button">
            </div>
        </a>
    </div>
    
    <div class="chat-title">Cookies Support</div>


<div class="container">
    <div class="date" id="chatDate"></div>
    <div class="chat-box" id="chatBox"></div>
    <p id="inactiveMessage" class="inactive-message">Conversation has been closed due to inactivity.</p>
</div>

<div class="input-container">
    <input type="text" id="messageInput" class="message-input" placeholder="Type a message...">
    <button class="send-btn" onclick="sendMessage()">Send</button>
    <button class="clear-btn" onclick="clearChat()">Clear Chat</button>
</div>

<script>
 let savedName = sessionStorage.getItem("profileName") || "User";
let chatBox = document.getElementById("chatBox");
let messageInput = document.getElementById("messageInput");
let inactiveMessage = document.getElementById("inactiveMessage");
let inactivityTimer;


// Show today's date
document.getElementById("chatDate").innerText = new Date().toDateString();

// Initial bot message
function startChat() {
    appendMessage(`Hi ${savedName}, welcome to Cookies Support!`, "bot");
    appendMessage("Please tell me the issue you are facing. I can help you.", "bot");
    resetInactivityTimer();
}

// Function to get current time in 12-hour format
function getCurrentTime() {
    let now = new Date();
    let hours = now.getHours();
    let minutes = now.getMinutes();
    let amPm = hours >= 12 ? "PM" : "AM";
    hours = hours % 12 || 12; // Convert to 12-hour format
    minutes = minutes < 10 ? "0" + minutes : minutes;
    return `${hours}:${minutes} ${amPm}`;
}

// Append a message to chat with timestamp
function appendMessage(text, sender) {
    let messageDiv = document.createElement("div");
    messageDiv.classList.add("message", sender === "bot" ? "bot-message" : "user-message");
    
    let timeSpan = document.createElement("span");
    timeSpan.classList.add("message-time");
    timeSpan.innerText = getCurrentTime();
    
    messageDiv.innerText = text;
    messageDiv.appendChild(timeSpan); // Add time next to message
    
    chatBox.appendChild(messageDiv);
    chatBox.scrollTop = chatBox.scrollHeight;
}

// Send user message
function sendMessage() {
    let message = messageInput.value.trim().toLowerCase();
    if (message === "") return;
    appendMessage(message, "user");
    messageInput.value = "";

    // Greeting responses
    if (["hi", "hello", "hey"].includes(message)) {
        setTimeout(() => {
            appendMessage(`Hello, ${savedName}! How can I assist you today? Let me know if you have any questions.`, "bot");
        }, 500);
        resetInactivityTimer();
        return;
    }

        // Payment issue responses
        if (["i have issue in payment", "payment", "payment options"].includes(message)) {
        setTimeout(() => {
            appendMessage(`If you have payment issues, you can directly contact our customer care.`, "bot");
        }, 500);
        setTimeout(() => {
            appendMessage(`We will connect you with our customer care.`, "bot");
        }, 1500);
        setTimeout(() => {
            appendMessage(`Which language do you need? English or Hindi?`, "bot");
        }, 2500);
        resetInactivityTimer();
        return;
    }

    // Language selection for payment/call
    if (["english", "hindi"].includes(message)) {
        setTimeout(() => {
            appendMessage(`Okay, we will call you within 5 minutes.`, "bot");
        }, 500);
        resetInactivityTimer();
        return;
    }

    // Unsupported language
    if (message.includes("call") || message.includes("language")) {
        if (!["english", "hindi"].includes(message)) {
            setTimeout(() => {
                appendMessage(`Sorry, this language isn't available now.`, "bot");
            }, 500);
            resetInactivityTimer();
            return;
        }
    }


    
    // Handle last ordered product request
    if (message.includes("last ordered product")) {
        setTimeout(() => {
        let orderedProducts = JSON.parse(localStorage.getItem("orderedProducts")) || [];
        if (orderedProducts.length > 0) {
            let lastProduct = orderedProducts[orderedProducts.length - 1];
            appendMessage(`Your last ordered product was ${lastProduct.name} for â‚¹${parseFloat(lastProduct.price).toFixed(2)} (Quantity: ${lastProduct.quantity}).`, "bot");
        } else {
            appendMessage("You have not ordered any products yet.", "bot");
        }
    }, 1000);
        return;
    }

    // Handle call request
    if (message.includes("call customer care")) {
        setTimeout(() => {
            appendMessage("Okay, which language do you need? English or Hindi?", "bot");
        }, 500);
        return;
    }

    // Handle language selection
    if (message === "english" || message === "hindi") {
        setTimeout(() => {
            appendMessage("Okay, we will call you within 5 minutes.", "bot");
        }, 500);
        return;
    }

    // Handle unsupported languages
    if (!["english", "hindi"].includes(message) && message.includes("call")) {
        setTimeout(() => {
            appendMessage("Sorry, support is not available in this language. Please try English or Hindi.", "bot");
        }, 500);
        return;
    }

    // Default bot response
    setTimeout(() => {
        let botReplies = [
            "I'm here to help you!",
            "Could you please provide more details?",
            "I understand. Let me assist you with that.",
            "Our support team will get in touch shortly."
        ];
        let reply = botReplies[Math.floor(Math.random() * botReplies.length)];
        appendMessage(reply, "bot");
    }, 1000);

    resetInactivityTimer();
}

// Reset inactivity timer
function resetInactivityTimer() {
    clearTimeout(inactivityTimer);
    inactiveMessage.style.display = "none";
    inactivityTimer = setTimeout(() => {
        inactiveMessage.style.display = "block";
        appendMessage("The conversation has been closed due to inactivity.", "bot");
    }, 3600000); // 1 hour
}

// Clear chat
function clearChat() {
    chatBox.innerHTML = "";
    inactiveMessage.style.display = "none";
    startChat();
}

// Handle Enter/Go key to send message
messageInput.addEventListener("keydown", function (event) {
    if (event.key === "Enter" || event.key === "Go") {
        event.preventDefault();  // Prevent default behavior like form submission
        sendMessage();           // Call your existing sendMessage function
    }
});


startChat();

 </script>
 

</body>
</html>
