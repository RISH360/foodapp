<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gift Card Purchase</title>
    <script src="appearance.js" defer></script>
    <link rel="stylesheet" href="appearance.css">

    <style>
 body {
    font-family: 'Poppins', sans-serif;
    background: #ebadad;
    margin: 0;
    padding: 0;
    padding-bottom: 80px; /* Adds space at the bottom */
}


/* Back Button */
.back-logo {
            position: absolute;
            top: 30px;
            left: 20px;
        }

        .back-logo img {
            width: 10px;
            height: auto;
            cursor: pointer;
        }



        .gift-title {
    width: 90%;
    max-width: 500px;
    font-size: 20px;
    font-weight: bold;
    text-align: left;
    margin: 60px auto 10px auto; /* Increased top margin */
    padding-left: 10px; /* Optional for spacing */
}

.container {
    max-width: 400px;
    margin: auto;
    background: white;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
    text-align: center;
}


/* Hide Scrollbar */
.categories, .card-slider {
    display: flex;
    gap: 10px;
    overflow-x: auto;
    padding-bottom: 10px;
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE/Edge */
}
.categories::-webkit-scrollbar, 
.card-slider::-webkit-scrollbar {
    display: none; /* Chrome, Safari */
}

.category {
    padding: 8px 15px;
    border-radius: 20px;
    border: 1px solid #ccc;
    background: white;
    font-size: 14px;
    cursor: pointer;
    white-space: nowrap;
}

.category.active {
    background: #f9dcdc;
    border-color: #f00;
}

.card-slider {
    gap: 15px;
    padding: 15px 0;
}

.card {
    min-width: 320px;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
    position: relative;
    cursor: pointer;
}

.card img {
    width: 100%;
    border-radius: 10px;
}

.card.selected::after {
    content: '\2713';
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    background: green;
    color: white;
    padding: 5px 10px;
    border-radius: 50%;
    font-size: 16px;
}

.amount-options {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }

        .amount-btn {
            padding: 10px 15px;
            border: 1px solid #ccc;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
        }

        .amount-btn.selected {
            background: #f9dcdc;
            border-color: #f00;
        }

        .custom-amount-container {
            display: none;
            margin-top: 10px;
            gap: 5px;
            justify-content: center;
            align-items: center;
        }

        #customAmount {
            width: 80px;
            padding: 5px;
            border-radius: 5px;
            text-align: center;
        }

        .add-btn, .clear-btn {
            padding: 6px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .add-btn {
            background: green;
            color: white;
            display: none;
        }

        .clear-btn {
            background: red;
            color: white;
        }

        .error {
            color: red;
            font-size: 14px;
            margin-top: 5px;
        }

        textarea#giftMessage {
            width: 90%;
            height: 120px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 10px;
            font-size: 14px;
            resize: none;
            display: block;
            margin: 15px auto;
        }

        .remove-btn {
        margin-left: 8px;
        cursor: pointer;
        font-size: 14px;
        color: red;
    }

    .footer-container {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background: white;
    padding: 15px 0;
    text-align: center;
    box-shadow: 0px -2px 10px rgba(0, 0, 0, 0.1);
}

.continue-btn {
    background-color: red;
    color: white;
    border: none;
    padding: 12px 20px;
    font-size: 16px;
    border-radius: 5px;
    cursor: pointer;
    width: 40%;
    max-width: 400px;
}

@media (max-width: 768px) { /* Targets mobile devices */
    .container {
        max-width: 85%; /* Adjust width dynamically */
        margin: auto;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
    }
}

/* Dark Mode - Gift Title */
.dark-mode .gift-title {
    color: #fff; /* White text for contrast */
}

/* Dark Mode - Container */
.dark-mode .container {
    background: #222; /* Dark background */
    box-shadow: 0px 4px 10px rgba(255, 255, 255, 0.1);
}

/* Dark Mode - Categories & Cards */
.dark-mode .categories,
.dark-mode .card-slider {
    background: #333; /* Darker background */
}

.dark-mode .category {
    background: #444;
    color: #fff;
    border: 1px solid #666;
}

.dark-mode .category.active {
    background: #661515;
    border-color: #ff4444;
}

/* Dark Mode - Card */
.dark-mode .card {
    background: #444;
    box-shadow: 0px 4px 10px rgba(255, 255, 255, 0.1);
}

.dark-mode .card.selected::after {
    background: #0f0;
}

/* Dark Mode - Amount Selection */
.dark-mode .amount-btn {
    background: #555;
    color: #fff;
    border-color: #777;
}

.dark-mode .amount-btn.selected {
    background: #661515;
    border-color: #ff4444;
}

/* Dark Mode - Custom Amount Input */
.dark-mode #customAmount {
    background: #333;
    color: #fff;
    border: 1px solid #666;
}

/* Dark Mode - Buttons */
.dark-mode .add-btn {
    background: #0a730a;
}

.dark-mode .clear-btn {
    background: #990000;
}

.dark-mode .remove-btn {
    color: #ff4444;
}

/* Dark Mode - Gift Message Box */
.dark-mode textarea#giftMessage {
    background: #333;
    color: #fff;
    border: 1px solid #555;
}

/* Dark Mode - Footer */
.dark-mode .footer-container {
    background: #111;
    box-shadow: 0px -2px 10px rgba(255, 255, 255, 0.1);
}

/* Dark Mode - Continue Button */
.dark-mode .continue-btn {
    background: #c00;
}

    </style>
</head>
<body>
    
    <div class="back-logo">
        <a href="settings.html" class="back-log">
            <div class="back-loco">
                <img src="static/pngkey.com-menu-icon-png-9694963.png" alt="back-button">
            </div>
        </a>
    </div>
    
    <div class="gift-title">Gift Cards</div>
    <div class="container">
        <div class="categories" id="categoryButtons">
            <button class="category active" onclick="showCards('birthday')">Birthday</button>
            <button class="category" onclick="showCards('anniversary')">Anniversary</button>
            <button class="category" onclick="showCards('wedding')">Wedding</button>
            <button class="category" onclick="showCards('getwell')">Get Well Soon</button>
            <button class="category" onclick="showCards('promotion')">Promotion</button>
            <button class="category" onclick="showCards('thankyou')">Thank You</button>
            <button class="category" onclick="showCards('sorry')">Sorry</button>
            <button class="category" onclick="showCards('others')">Others</button>
        </div>
        
        <div class="card-slider" id="giftCards"></div>
        

        <h3>Choose Amount</h3>
        <div class="amount-options" id="amountOptions">
            <button class="amount-btn" onclick="selectAmount(1000, this)">₹1,000</button>
<button class="amount-btn" onclick="selectAmount(2000, this)">₹2,000</button>
<button class="amount-btn" onclick="selectAmount(5000, this)">₹5,000</button>

            <button class="amount-btn" onclick="showCustomInput()">Custom</button>
        </div>

        <div class="custom-amount-container" id="customAmountContainer">
            <input type="number" id="customAmount" placeholder="Enter Amount" oninput="validateCustomAmount()">
            <button class="add-btn" id="addCustomAmountBtn" onclick="addCustomAmount()">Add</button>
            <button class="clear-btn" onclick="clearCustomAmount()">Clear</button>
        </div>
        <p id="error-message" class="error"></p>

        <h3>Add Message (Optional)</h3>
        <textarea id="giftMessage" placeholder="Write your message..."></textarea>
    </div>

    <div class="footer-container">
        <button class="continue-btn" onclick="goToBillSummary()">Continue</button>
    </div>
    


  <script>
 const cardData = {
    birthday: [
        { img: 'static/momo-mia-non-veg379d4c86ba9551f194bfc68ad9d77bc51.jpg', code: generatePin() },
        { img: 'b2.jpg', code: generatePin() },
        { img: 'b3.jpg', code: generatePin() },
        { img: 'b4.jpg', code: generatePin() },
        { img: 'b5.jpg', code: generatePin() }
    ],
    anniversary: [
        { img: 'a1.jpg', code: generatePin() },
        { img: 'a2.jpg', code: generatePin() },
        { img: 'a3.jpg', code: generatePin() },
        { img: 'a4.jpg', code: generatePin() },
        { img: 'a5.jpg', code: generatePin() }
    ],
    wedding: [
        { img: 'w1.jpg', code: generatePin() },
        { img: 'w2.jpg', code: generatePin() },
        { img: 'w3.jpg', code: generatePin() },
        { img: 'w4.jpg', code: generatePin() },
        { img: 'w5.jpg', code: generatePin() }
    ],
    getwell: [
        { img: 'g1.jpg', code: generatePin() },
        { img: 'g2.jpg', code: generatePin() },
        { img: 'g3.jpg', code: generatePin() },
        { img: 'g4.jpg', code: generatePin() },
        { img: 'g5.jpg', code: generatePin() }
    ],
    promotion: [
        { img: 'p1.jpg', code: generatePin() },
        { img: 'p2.jpg', code: generatePin() },
        { img: 'p3.jpg', code: generatePin() },
        { img: 'p4.jpg', code: generatePin() },
        { img: 'p5.jpg', code: generatePin() }
    ],
    thankyou: [
        { img: 't1.jpg', code: generatePin() },
        { img: 't2.jpg', code: generatePin() },
        { img: 't3.jpg', code: generatePin() },
        { img: 't4.jpg', code: generatePin() },
        { img: 't5.jpg', code: generatePin() }
    ],
    sorry: [
        { img: 's1.jpg', code: generatePin() },
        { img: 's2.jpg', code: generatePin() },
        { img: 's3.jpg', code: generatePin() },
        { img: 's4.jpg', code: generatePin() },
        { img: 's5.jpg', code: generatePin() }
    ],
    others: [
        { img: 'o1.jpg', code: generatePin() },
        { img: 'o2.jpg', code: generatePin() },
        { img: 'o3.jpg', code: generatePin() },
        { img: 'o4.jpg', code: generatePin() },
        { img: 'o5.jpg', code: generatePin() }
    ]
    // Repeat the same for other categories...
};

let customAmounts = [];
let holdTimer;

// Function to generate a 16-digit unique PIN
function generatePin() {
    return Math.floor(1000000000000000 + Math.random() * 9000000000000000).toString();
}

// Show gift cards based on category
function showCards(category) {
    document.querySelectorAll('.category').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');

    let giftCards = document.getElementById('giftCards');
    giftCards.innerHTML = '';

    cardData[category].forEach(card => {
        let cardDiv = document.createElement('div');
        cardDiv.classList.add('card');
        cardDiv.innerHTML = `<img src="${card.img}" onclick="selectCard(this, '${card.code}')">`;
        giftCards.appendChild(cardDiv);
    });
}

// Select a gift card
function selectCard(img, pin) {
    document.querySelectorAll('.card').forEach(card => card.classList.remove('selected'));
    img.parentElement.classList.add('selected');

    // Store the selected PIN code but do not display it
    localStorage.setItem("selectedPinCode", pin);
}

// Select an amount
function selectAmount(amount, btn) {
    document.querySelectorAll('.amount-btn').forEach(b => b.classList.remove('selected'));
    btn.classList.add('selected');
    btn.setAttribute('data-amount', amount);

    document.getElementById('customAmountContainer').style.display = 'none';

    // Store selected amount
    localStorage.setItem("selectedAmount", amount);
    localStorage.setItem("grandTotal", amount);
}

// Show custom amount input
function showCustomInput() {
    document.getElementById('customAmountContainer').style.display = 'flex';
    document.getElementById('customAmount').value = '';
    document.getElementById('addCustomAmountBtn').style.display = 'none';
    document.getElementById('error-message').textContent = '';
}

// Validate custom amount
function validateCustomAmount() {
    let amount = document.getElementById('customAmount').value;
    let errorMessage = document.getElementById('error-message');
    let addButton = document.getElementById('addCustomAmountBtn');

    if (amount < 250 || amount > 10000) {
        errorMessage.textContent = 'Amount should be between ₹250 and ₹10,000';
        addButton.style.display = 'none';
    } else {
        errorMessage.textContent = '';
        addButton.style.display = 'inline-block';
    }
}

// Add custom amount as button
function addCustomAmount() {
    let amount = document.getElementById('customAmount').value;

    if (!amount || amount < 250 || amount > 10000) {
        alert("Please enter an amount between ₹250 and ₹10,000.");
        return;
    }

    if (customAmounts.length >= 6) {
        alert("You can add up to 6 custom amounts.");
        return;
    }

    if (customAmounts.includes(amount)) {
        alert("Amount already added.");
        return;
    }

    customAmounts.push(amount);
    let amountOptions = document.getElementById('amountOptions');

    let newButton = document.createElement('button');
    newButton.classList.add('amount-btn');
    newButton.textContent = `₹${amount}`;
    newButton.setAttribute('data-amount', amount);

    newButton.addEventListener('click', function () {
        selectAmount(amount, this);
    });

    newButton.addEventListener('mousedown', function () {
        holdTimer = setTimeout(() => showRemoveOption(newButton), 1000);
    });

    newButton.addEventListener('mouseup', function () {
        clearTimeout(holdTimer);
    });

    newButton.addEventListener('mouseleave', function () {
        clearTimeout(holdTimer);
    });

    amountOptions.appendChild(newButton);
    document.getElementById('customAmountContainer').style.display = 'none';
}

// Show remove option for custom amount
function showRemoveOption(button) {
    let removeBtn = document.createElement('span');
    removeBtn.textContent = "❌";
    removeBtn.classList.add('remove-btn');
    removeBtn.onclick = function () {
        removeCustomAmount(button);
    };
    button.appendChild(removeBtn);
}

// Remove custom amount
function removeCustomAmount(button) {
    let amount = button.getAttribute('data-amount');
    customAmounts = customAmounts.filter(a => a !== amount);
    button.remove();
}

// Clear custom amount input
function clearCustomAmount() {
    document.getElementById('customAmount').value = '';
    document.getElementById('addCustomAmountBtn').style.display = 'none';
    document.getElementById('error-message').textContent = '';
}

function goToBillSummary() {
    let selectedCard = document.querySelector('.card.selected img');
    let selectedAmount = document.querySelector('.amount-btn.selected');
    let giftMessage = document.getElementById("giftMessage").value; // Get message

    if (!selectedCard || !selectedAmount) {
        alert("Please select a gift card and an amount.");
        return;
    }

    // Store selected values in localStorage
    localStorage.setItem("selectedImage", selectedCard.src);
    localStorage.setItem("selectedAmount", selectedAmount.getAttribute('data-amount'));
    localStorage.setItem("grandTotal", selectedAmount.getAttribute('data-amount')); // Adjust logic if needed
    localStorage.setItem("giftMessage", giftMessage); // Store gift message

    window.location.href = "cardpayment.html";
}

</script>

    
</body>
</html>